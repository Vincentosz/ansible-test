---



- hosts: all

  become: true

  pre_tasks:



  - name: Install updates (Fedora)

    dnf:

      update_only: yes

      update_cache: yes

    when: ansible_distribution == "Fedora"



  - name: Install updates (Debian)

    apt:

      upgrade: dist

      update_cache: yes

    when: ansible_distribution == "Debian"





- hosts: web_servers

  become: true

  tasks:



  - name: Install httpd and php packages (Fedora)

    dnf:

      name:

        - httpd

        - php

      state: latest

    when: ansible_distribution == "Fedora"



  - name: Install apache2 and php packages (Debian)

    apt:

      name:

        - apache2

        - libapache2-mod-php

      state: latest

    when: ansible_distribution == "Debian"





- hosts: db_servers

  become: true

  tasks:



  - name: Install MariaDB (Fedora)

    dnf:

      name: mariadb

      state: latest

    when: ansible_distribution == "Fedora"



  - name: Install MariaDB server (Debian)

    apt:

      name: mariadb-server

      state: latest
    when: ansible_distribution == "Debian"
